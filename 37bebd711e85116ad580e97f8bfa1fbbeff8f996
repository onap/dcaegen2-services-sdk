{
  "comments": [
    {
      "key": {
        "uuid": "cf21c3fc_b55b9b7c",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 52,
      "author": {
        "id": 93
      },
      "writtenOn": "2019-10-16T16:00:18Z",
      "side": 1,
      "message": "For a component having use_tls:false in blueprint, these files will not available.",
      "range": {
        "startLine": 51,
        "startChar": 2,
        "endLine": 52,
        "endChar": 37
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7c347446_b1cb3257",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 52,
      "author": {
        "id": 2807
      },
      "writtenOn": "2019-10-17T10:34:03Z",
      "side": 1,
      "message": "I\u0027ve tested the solution with a single Cacert file.\n \nCBS Client was not able to establish a TLS handshake due to not valid path to the cert. This issue can be a workaround by adding the Cacert to the Truststore file. \n\nOn the other hand, we have already created TrustStore which already has a Cacert file in it. (solution worked on our lab) \n\nSo the question is can we modify existing logic related to the use_tls flag to ensure that \"trust.jks\", \"trust.pass\", \"cert.jks\", \"jks.pass\" will be placed on the environment just like Cacert file?",
      "parentUuid": "cf21c3fc_b55b9b7c",
      "range": {
        "startLine": 51,
        "startChar": 2,
        "endLine": 52,
        "endChar": 37
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa6c2c99_fe28f694",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 72,
      "author": {
        "id": 93
      },
      "writtenOn": "2019-10-16T16:00:18Z",
      "side": 1,
      "message": "This is not env exposed by the plugin explicitly, I think k8s deployment automatically exposes these based on service definition. Using this env as is okay, other option will be define a constant for secure port as 10443 use it.",
      "range": {
        "startLine": 72,
        "startChar": 34,
        "endLine": 72,
        "endChar": 76
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e0d679ba_08e8313c",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 72,
      "author": {
        "id": 2807
      },
      "writtenOn": "2019-10-17T10:34:03Z",
      "side": 1,
      "message": "ok I will set a constant",
      "parentUuid": "fa6c2c99_fe28f694",
      "range": {
        "startLine": 72,
        "startChar": 34,
        "endLine": 72,
        "endChar": 76
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f11b3095_88f04479",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 156,
      "author": {
        "id": 93
      },
      "writtenOn": "2019-10-16T16:00:18Z",
      "side": 1,
      "message": "If cert/trust file is not available CBS connection could fail. How about default to CBS HTTP in such case?",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 66
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "88eee8fc_7c72d4a2",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 156,
      "author": {
        "id": 2837
      },
      "writtenOn": "2019-10-17T05:31:55Z",
      "side": 1,
      "message": "Plain http is realised in first code block above.\nLines 148 - 152\nThis is suitable for current design of k8s plugin.",
      "parentUuid": "f11b3095_88f04479",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 66
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "87d282f4_a5ea2853",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 156,
      "author": {
        "id": 93
      },
      "writtenOn": "2019-11-04T04:56:28Z",
      "side": 1,
      "message": "pathToCaCert will be set by default when k8s plugin version 1.6.0 (or later) is used; however trust.key and trust.pass will not be available by default (unless use_tls is also set) hence this may result in an exception? Let me know if you think otherwise.",
      "parentUuid": "88eee8fc_7c72d4a2",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 66
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b2d51e5_662b6e84",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 156,
      "author": {
        "id": 2807
      },
      "writtenOn": "2019-11-04T10:54:29Z",
      "side": 1,
      "message": "It seems that we did not get along with this Cbs Client certificates.\n\nI proposed to put ALL the JKS certificates (trust.jks, cert.jks) with THEIR PASSWORDS to the same dir as cacert.pem. \n\nCurrent logic, I meant the SecurityKeys.java class is using all these JKS files (with their passwords) to establish an SSL connection. \n\nThe benefits of such an approach are:\n - more general code to use \n - support for one way TLS (trust.jks)\n - support mutual TLS (trust.jks, cert.jks)\n - passwords for certs are in place (we don\u0027t need to create them using KEY_TOOL in some shell script) \n - worked in production\n - get rid of additional code which handles almost the same functionality (cacert.pem included in trust.jks)  \n\nI was convinced this approach is more efficient from SDK CBS Clint\u0027s point of view.\n\n-----------------------------------------------------------------------------------------------------\n\nThe more reasonable and concise solution is to get rid of DCAE_CA_CERT_PATH which points to cacert.pem file\n\n(like \"/opt/app/prh/component-name/etc/cert/cacert.pem\")\n\nand set DCAE_JKS_CERTS_PATH which points to dir where \"cert.jks\", \"jks.pass\", \"trust.jks\", \"trust.pass\" are present.\n(like \"/opt/app/prh/component-name/etc/cert/\") \n\nDue to what I mentioned above, we are not using cacert.pem for establishing an SSL context in this commit.\n\n\n--------------------------------------------------------------------------------------------------------------\n\n\"pathToCaCert will be set by default when k8s plugin version 1.6.0 (or later) is used; however trust.key and trust.pass will not be available by default (unless use_tls is also set) hence this may result in an exception?\"\n\nIf some of: \"cert.jks\", \"jks.pass\", \"trust.jks\", \"trust.pass\" will be not present in pathToCaCert directory, excepiton will be thrown.",
      "parentUuid": "87d282f4_a5ea2853",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 66
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "24c8a372_be5c2ce2",
        "filename": "rest-services/cbs-client/src/main/java/org/onap/dcaegen2/services/sdk/rest/services/cbs/client/model/CbsClientConfiguration.java",
        "patchSetId": 15
      },
      "lineNbr": 156,
      "author": {
        "id": 93
      },
      "writtenOn": "2019-11-04T18:05:29Z",
      "side": 1,
      "message": "Appears we are going back to option#2 noted on 10/24 notes? During our meeting, I thought there were consensus to support option#3 and Damian also suggested looking into this option.\n\nThe env setting - DCAE_CA_CERT_PATH  is being used by ConfigBinginService and works(this is python component though). As DCAE services includes both java and python components, option#3 (plugin update) was discussed to enhance distribution of other files required for java component.\n\nAlthough we can approach this in phases i.e proceed option#2 for Frankfurt and move to option#3 as target post Frankfurt. If so, any clients looking to switch to CBS https using this SDK version MUST have use_tls flag set in their blueprint during the interim time. Any issues/concern by this approach?\n\nPiotr - Can you clarify what is behavior using this SDK version when DCAE_CA_CERT_PATH is defined but it doesn\u0027t include all the cert files SDK needs? This is possible case if the blueprint uses newer K8S plugin and does not set use_tls to true. Doesn\u0027t seem like this scenario is handled in code; can you check/confirm?",
      "parentUuid": "7b2d51e5_662b6e84",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 66
      },
      "revId": "37bebd711e85116ad580e97f8bfa1fbbeff8f996",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    }
  ]
}